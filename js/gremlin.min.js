/**!
 * GremlinJS 0.3.0
 * https://github.com/grmlin/gremlinjs
 *
 * Copyright 2012, Andreas Wehr
 * Released under the MIT License
 */

(function(){(function(){var e={}.hasOwnProperty;define("gremlinjs/core/helper",[],function(){var t,n,r,i,s,o,u,a;return o="undefined",i="object",s="string",n="function",r="number",t=0,a=function(t,n){var r,i;for(i in n){if(!e.call(n,i))continue;r=n[i],t[i]=r}return t},u={isUndefined:function(e){return typeof e===o},isFunction:function(e){return typeof e===n},isArray:function(e){return e instanceof Array},isObject:function(e){return e!==null&&typeof e===i&&!u.isArray(e)},isNumber:function(e){return typeof e===r},isString:function(e){return typeof e===s},isEmptyString:function(e){return u.isString(e)&&e.length===t},isJquery:function(e){return u.isObject(e)&&u.isString(e.jquery)},log:function(){if(u.isObject(console)&&u.isFunction(console.log))return console.log.apply(console,arguments)},warn:function(){if(u.isObject(console)&&u.isFunction(console.warn))return console.warn.apply(console,arguments)},mixin:function(e,t){return a(e.prototype,t)}}})}).call(this),function(){define("gremlinjs/gremlins/GremlinFactory",["../core/helper"],function(e){var t,n;return n=0,t={createGremlin:function(t,r,i){return require([t],function(s){var o;return e.isFunction(s)?(o=new s(r,r.data(),n+=1),i.apply(null,[o])):e.warn("gremlinjs/gremlins/GremlinFactory#createGremlin> The gremlin module "+t+" didn't return a (constructor) function and will not work!")})}}})}.call(this),function(){define("gremlinjs/gremlins/GremlinSwitchboard",["../core/helper"],function(e){var t,n;return t={},n={register:function(e){var t,n,r,i,s;e.bind(e.NOTIFICATION,this._broadcast,this),i=e.interests,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this._addInterest(e,t));return s},_broadcast:function(n,r){var i,s,o,u,a,f,l;s=r.interest,o=r.notificationData;if(!e.isUndefined(t[s])){f=t[s],l=[];for(u=0,a=f.length;u<a;u++)i=f[u],l.push(this.__notify(i,s,o));return l}},_addInterest:function(n,r){return(e.isUndefined(t[r])?t[r]=[]:void 0).push(n)},__notify:function(e,t,n){return e.inform(t,n)}}})}.call(this),function(){define("gremlinjs/gremlins/Loader",["jquery","../core/helper","./GremlinFactory","./GremlinSwitchboard"],function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d;return d=0,s=e(window),i=e("body"),c=",",u="data-gremlin-name",o="data-lazy-load",a="gremlin",f="",l="gremlin-loading",p=[],h=function(){function i(e,t){this._namespace=e!=null?e:f,this._gremlinCssClass=t!=null?t:a;if(!(this instanceof i))throw new Error("gremlinjs.gremlins.Loader#Loader Missing new. The Loader is a constructor function.");this._lazyLoadQueue=[],this._bindLazyLoading()}return i.prototype.load=function(n){var r,i=this;return this._cleanUp(),t.isJquery(n)?r=n.find("."+this._gremlinCssClass):r=e("."+this._gremlinCssClass),r.each(function(e,n){var r,s,o,a,f,l;s=n.getAttribute(u);if(!t.isString(s)||t.isEmptyString(s))throw new Error("Can't create a gremlin without a classname defined for it.");f=s.split(c),l=[];for(o=0,a=f.length;o<a;o++){r=f[o],r=i._namespace+r;if(!t.isString(r)||!!t.isEmptyString(r))throw new Error("Can't create a gremlin without a classname defined for it.");l.push(i._addGremlin(r,n))}return l}),this._handleScrollEvent()},i.prototype.resetLazyGremlins=function(){var e,t,n,r,i;r=this._lazyLoadQueue,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],e.top=e.$element.offset().top,i.push(e.height=e.$element.outerHeight());return i},i.prototype._bindLazyLoading=function(){var e,t,n=this;return e=null,t="scroll.Loader"+(d+=1),this._lazyLoadQueue=[],s.unbind(t).bind(t,function(){return e&&clearTimeout(e),e=setTimeout(function(){return n._handleScrollEvent()},250)})},i.prototype._addGremlin=function(t,n){var r,i;return r=e(n),i=n.getAttribute(o)==="true",r.addClass(l).removeClass(this._gremlinCssClass),i?this._lazyLoadQueue.push({name:t,$element:r,top:r.offset().top,height:r.outerHeight()}):this._createGremlin(t,r)},i.prototype._createGremlin=function(e,t){var i=this;return n.createGremlin(e,t,function(e){return p.push(e),e.bind(e.NOTIFICATION,function(t,n){if(n.interest===e.CONTENT_CHANGED)return i.load(e.view)}),t.removeClass(l),r.register(e),!0})},i.prototype._handleScrollEvent=function(){var e;return e=s.scrollTop(),this._checkLazyGremlins(e-100,e+100+s.height())},i.prototype._checkLazyGremlins=function(e,t){var n,r,i,s,o,u;if(this._lazyLoadQueue.length>0){r=[],o=this._lazyLoadQueue,u=[];for(i=0,s=o.length;i<s;i++)n=o[i],n.top+n.height>e&&n.top<t?this._createGremlin(n.name,n.$element):r.push(n),u.push(this._lazyLoadQueue=r);return u}},i.prototype._cleanUp=function(){var e,t,n,r,i;e=[];for(n=0,r=p.length;n<r;n++)t=p[n],((i=t.view)!=null?i.closest("html").length:void 0)===0?t=null:e.push(t);return p=e},i}(),h})}.call(this),function(){define("gremlinjs/gremlins/LoaderPool",["./Loader"],function(e){var t,n;return t={},n={getInstance:function(n,r){var i;return i=""+n+"_"+r,t[i]||(t[i]=new e(n,r))}}})}.call(this),function(){define("gremlinjs/event/EventDispatcher",["../core/helper"],function(e){var t;return t={_observers:null,bind:function(t,n,r){var i;r==null&&(r=null),this._observers||(this._observers={});if(e.isUndefined(t))throw new Error("Event-type undefined.");if(!e.isFunction(n))throw new Error("Trying to add an event listener without defining a callback function.");return(i=this._observers)[t]||(i[t]=[]),this._observers[t].push({listener:n,context:r})},unbind:function(t,n,r){var i,s,o,u,a,f,l,c;r==null&&(r=null),this._observers||(this._observers={}),a=this._observers[t];if(e.isFunction(n)){c=[];for(o=f=0,l=a.length;f<l;o=++f){u=a[o],i=u.listener,s=u.context;if(n===i&&r===s){a.splice(o,1);break}c.push(void 0)}return c}return delete this._observers[t]},dispatch:function(t,n){var r,i,s,o,u,a,f,l,c;this._observers||(this._observers={});if(!e.isString(t))throw new Error("Trying to dispatch a non-standard event.");u=this._observers[t]||[],a=function(){var e,r,a;a=[];for(i=e=0,r=u.length;e<r;i=++e)o=u[i],s=o.listener,a.push(function(e,t,n,r){return n==null&&(n=null),function(){return e.apply(t,[r,n])}}(s,o.context,n,t));return a}(),c=[];for(f=0,l=a.length;f<l;f++)r=a[f],c.push(r());return c},hasEventListener:function(t){return this._observers||(this._observers={}),e.isArray(this._observers[t])&&this._observers[t].length>0}},t})}.call(this),function(){var e={}.hasOwnProperty;define("gremlinjs/gremlins/AbstractGremlin",["../core/helper","../event/EventDispatcher"],function(t,n){var r,i,s;return i=function(t){var n,r,i,s;if(this.elements!==null){i=this.elements,s=[];for(r in i){if(!e.call(i,r))continue;n=i[r],s.push(this[n]=this.view.find(r))}return s}},s=function(n){var r,i,s,o,u,a,f,l,c=this;if(this.events!==null){f=this.events,l=[];for(r in f){if(!e.call(f,r))continue;u=f[r];switch(typeof u){case"function":o=u;break;case"string":(function(){if(t.isFunction(c[u]))return o=c[u];throw new TypeError("Event '"+r+"' can't be bound to '"+c.name+"."+u+"', as the type is "+typeof c[u])})();break;default:throw new TypeError("The event handler for '"+this.name+'.events["'+r+"â€]' has to be a method or a string referencing an instance method of this class, currently its "+typeof u)}s=r.indexOf(" "),i=r.substr(0,s),a=r.length>s+1?r.substr(s+1):null,this.view.on(i,a,function(){return o.apply(c,arguments),!0}),l.push(!0)}return l}},r=function(){function e(e,t,n){this.view=e,this.data=t,this.id=n,i.call(this,this.elements),s.call(this,this.events),this.interests===null&&(this.interests=[]),this.initialize()}return e.prototype.name="anonymous",e.prototype.NOTIFICATION="GREMLIN_NOTIFICATION",e.prototype.CONTENT_CHANGED="gremlinjs_gremlin_content_changed",e.prototype.initialize=function(){return t.warn("Gremlin <"+this.name+"> does not implement an own #initialize method.")},e.prototype.elements=null,e.prototype.events=null,e.prototype.interests=null,e.prototype.inform=function(e,t){},e.prototype.chatter=function(e,t){return t==null&&(t={}),this.dispatch(this.NOTIFICATION,{interest:e,notificationData:t})},e.prototype.triggerChange=function(){return this.chatter(this.CONTENT_CHANGED)},e}(),t.mixin(r,n),r})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("gremlinjs/gremlins/GremlinLair",["../core/helper","./AbstractGremlin"],function(e,n){var r;return r={create:function(r,i){var s;return s=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.name=r,n}(n),e.mixin(s,i),s}}})}.call(this),function(){define("gremlinjs",["./gremlinjs/gremlins/LoaderPool","./gremlinjs/gremlins/GremlinLair"],function(e,t){return{create:t.create,getLoader:e.getInstance}})}.call(this),require(["./gremlinjs"]),define("gremlinMain",function(){})})()